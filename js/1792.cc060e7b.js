"use strict";(self.webpackChunkvue3_antd_admin=self.webpackChunkvue3_antd_admin||[]).push([[1792,4334,3293,9941,7655,3287],{44870:function(e,n,t){t.a(e,(async function(e){var r=t(88478),a=t(48534),u=t(54621),o=t(95082),i=(t(35666),t(41539),t(26699),t(32023),t(92222),t(78783),t(33948),t(21249),t(68309),t(66252)),d=t(2262),l=t(83529),c=t(7732),s=t(94124),f=t(76478),p=t(80715),h=t(77655),m=t(13287),v=t(28747),g=e([l,f,s,c,p]);[l,f,s,c,p]=g.then?await g:g;var b=(0,i.Uk)(" 新增 ");n.Z=(0,i.aZ)((0,o.Z)((0,o.Z)({},{name:"SystemPermissionRole"}),{},{setup:function(e){var n=(0,d.iH)(),t=(0,p.U)(),g=(0,u.Z)(t,1)[0],y=function e(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return t.reduce((function(t,a){var u;return null!==(u=a.children)&&void 0!==u&&u.length?e(n,a.children,r):n.includes(a.value)&&t.push(a.value),t}),r)},k=function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t){var i,d,f,p,h,b,k,x,w,I,Z,W,R,P;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g({modalProps:{title:"".concat(t.id?"编辑":"新增","角色"),width:"50%",onFinish:function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(a){var u,i,d,c,s,f,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.id&&(a.roleId=t.id),f=null===(u=p.value)||void 0===u||null===(i=u.compRefs)||void 0===i?void 0:i.menus,h=null===(d=p.value)||void 0===d||null===(c=d.compRefs)||void 0===c?void 0:c.depts,m=(0,o.Z)((0,o.Z)({},a),{},{menus:[].concat((0,r.Z)(f.halfCheckedKeys),(0,r.Z)(f.checkedKeys)),depts:[].concat((0,r.Z)(h.halfCheckedKeys),(0,r.Z)(h.checkedKeys))}),e.next=7,(t.id?l.ul:l.fA)(m);case 7:null===(s=n.value)||void 0===s||s.refreshTable();case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},formSchema:{labelWidth:100,layout:"vertical",schemas:m.roleSchemas}});case 2:return d=e.sent,f=(0,u.Z)(d,1),p=f[0],e.next=7,Promise.all([(0,c.U4)(),(0,s.Af)()]);case 7:if(h=e.sent,b=(0,u.Z)(h,2),k=b[0],x=b[1],w=(0,v.bl)(x),I=(0,v.fl)(k),null===(i=p.value)||void 0===i||i.updateSchema([{field:"menus",componentProps:{treeData:w}},{field:"depts",componentProps:{treeData:I}}]),!t.id){e.next=21;break}return e.next=17,(0,l.Xt)({roleId:t.id});case 17:W=e.sent,R=W.menus.map((function(e){return e.menuId})),P=W.depts.map((function(e){return e.departmentId})),null===(Z=p.value)||void 0===Z||Z.setFieldsValue((0,o.Z)((0,o.Z)({},t),{},{name:W.roleInfo.name,label:W.roleInfo.label,remark:W.roleInfo.remark,menus:y(R,w),depts:y(P,I)}));case 21:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),x=function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.Rd)({roleIds:[t.id]});case 2:null===(r=n.value)||void 0===r||r.refreshTable();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),w=[].concat((0,r.Z)(h.baseColumns),[{title:"操作",width:160,dataIndex:"$action",hideInSearch:!0,align:"center",fixed:"right",actions:function(e){var n=e.record;return[{label:"编辑",auth:{perm:"sys.role.update",effect:"disable"},onClick:function(){return k(n)}},{label:"删除",auth:"sys.role.delete",popConfirm:{title:"你确定要删除吗？",onConfirm:function(){return x(n)}}}]}}]);return function(e,t){var r=(0,i.up)("a-button");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)((0,d.SU)(f.DynamicTable),{ref_key:"dynamicTableRef",ref:n,"row-key":"id","header-title":"角色管理","data-request":(0,d.SU)(l.$s),columns:w,bordered:"",size:"small"},{toolbar:(0,i.w5)((function(){return[(0,i.Wm)(r,{type:"primary",disabled:!e.$auth("sys.role.add"),onClick:t[0]||(t[0]=function(e){return k({})})},{default:(0,i.w5)((function(){return[b]})),_:1},8,["disabled"])]})),_:1},8,["data-request"])])}}}))}))},7732:function(e,n,t){t.a(e,(async function(e){t.d(n,{U4:function(){return o},aS:function(){return i},MB:function(){return d},UJ:function(){return l},m3:function(){return c}});var r=t(30803),a=t(16576),u=e([r]);function o(){return(0,r.W)({url:a.default.list,method:"get"})}function i(e){return(0,r.W)({url:"sys/dept/delete",method:"post",data:e},{successMsg:"删除成功"})}function d(e){return(0,r.W)({url:a.default.update,method:"post",data:e})}function l(e){return(0,r.W)({url:a.default.add,method:"post",data:e})}function c(e){return(0,r.W)({url:a.default.transfer,method:"post",data:e})}r=(u.then?await u:u)[0]}))},94124:function(e,n,t){t.a(e,(async function(e){t.d(n,{Af:function(){return o},ZT:function(){return i},_8:function(){return d},RD:function(){return l}});var r=t(30803),a=t(88573),u=e([r]);function o(){return(0,r.W)({url:a.default.list,method:"get"})}function i(e){return(0,r.W)({url:a.default.add,method:"post",data:e},{successMsg:"创建成功"})}function d(e){return(0,r.W)({url:a.default.update,method:"post",data:e},{successMsg:"更新成功"})}function l(e){return(0,r.W)({url:a.default.delete,method:"post",data:e},{successMsg:"删除成功"})}r=(u.then?await u:u)[0]}))},83529:function(e,n,t){t.a(e,(async function(e){t.d(n,{Xt:function(){return o},JV:function(){return i},$s:function(){return d},fA:function(){return l},ul:function(){return c},Rd:function(){return s}});var r=t(30803),a=t(2874),u=e([r]);function o(e){return(0,r.W)({url:a.default.info,method:"get",params:e})}function i(e){return(0,r.W)({url:a.default.list,method:"get",data:e})}function d(e){return(0,r.W)({url:a.default.page,method:"get",params:e})}function l(e){return(0,r.W)({url:a.default.add,method:"post",data:e},{successMsg:"创建角色成功"})}function c(e){return(0,r.W)({url:a.default.update,method:"post",data:e},{successMsg:"更新角色成功"})}function s(e){return(0,r.W)({url:a.default.delete,method:"post",data:e},{successMsg:"删除角色成功"})}r=(u.then?await u:u)[0]}))},28747:function(e,n,t){t.d(n,{fl:function(){return r},bl:function(){return a},BQ:function(){return u}});t(21249),t(57327),t(41539),t(92222),t(68309);var r=function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return n.filter((function(e){return e.parentId===t})).map((function(a){var u=r.concat(t||[]),o=e(n,a.id,u);return Object.assign(a,{keyPath:u,title:a.name,key:a.id,value:a.id,formData:a,children:o.length?o:null})}))},a=function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return n.filter((function(e){return e.parentId===t})).map((function(a){var u=r.concat(t||[]),o=e(n,a.id,u);return Object.assign(a,{keyPath:u,title:a.name,key:a.id,value:a.id,formData:a,children:o.length?o:null})}))},u=function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"children";return t.reduce((function(t,u){var o;return u[r]===n?u:t||(null!==(o=u[a])&&void 0!==o&&o.length?e(n,u[a],r,a):void 0)}),void 0)}},13287:function(e,n,t){t.r(n),t.d(n,{roleSchemas:function(){return r}});var r=[{field:"name",component:"Input",label:"名称",rules:[{required:!0,type:"string"}],colProps:{span:12}},{field:"label",component:"Input",label:"标识",rules:[{required:!0,type:"string"}],colProps:{span:12}},{field:"remark",component:"InputTextArea",label:"备注"},{field:"menus",component:"Tree",label:"菜单权限",colProps:{span:12},componentProps:{checkable:!0,vModelKey:"checkedKeys",style:{height:"300px",paddingTop:"5px",overflow:"auto",borderRadius:"6px",border:"1px solid #dcdfe6"}}},{field:"depts",component:"Tree",label:"部门权限",colProps:{span:12},componentProps:{checkable:!0,vModelKey:"checkedKeys",style:{height:"300px",paddingTop:"5px",overflow:"auto",borderRadius:"6px",border:"1px solid #dcdfe6"}}}]},77655:function(e,n,t){t.r(n),t.d(n,{baseColumns:function(){return r}});var r=[{title:"#",dataIndex:"id",width:55,align:"center",hideInSearch:!0},{title:"名称",width:200,align:"center",dataIndex:"name"},{title:"标识",width:80,align:"center",dataIndex:"label"},{title:"备注",dataIndex:"remark",align:"center"},{title:"创建时间",dataIndex:"createdAt",align:"center",hideInSearch:!0},{title:"更新时间",align:"center",dataIndex:"updatedAt",hideInSearch:!0}]},1847:function(e,n,t){t.a(e,(async function(e){t.r(n);var r=t(7462),a=e([r]);const u=(r=(a.then?await a:a)[0]).Z;n.default=u}))},7462:function(e,n,t){t.a(e,(async function(e){t.d(n,{Z:function(){return r.Z}});var r=t(44870),a=e([r]);r=(a.then?await a:a)[0]}))}}]);